<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Presensi Admin</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
  <div class="container">
    <a class="navbar-brand fw-semibold" href="./index.html">Presensi</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#topnav" aria-controls="topnav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div id="topnav" class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="./index.html">Karyawan</a></li>
        <li class="nav-item"><a class="nav-link active" aria-current="page" href="./admin.html">Admin</a></li>
      </ul>
    </div>
  </div>
</nav>

<main class="container py-4">
  <div id="alerts"></div>

  <!-- Login Card -->
  <div id="loginCard" class="card border-0 shadow-sm">
    <div class="card-body">
      <h5 class="card-title mb-3">Masuk Admin</h5>
      <div class="row g-3">
        <div class="col-12 col-md-4">
          <label class="form-label">Admin ID</label>
          <input id="adminId" class="form-control" placeholder="mis. adm001" value="adm001">
        </div>
        <div class="col-12 col-md-4">
          <label class="form-label">Key</label>
          <input id="adminKey" class="form-control" placeholder="mis. 1234" value="1234">
        </div>
        <div class="col-12 col-md-4 d-grid align-items-end">
          <button id="btnLogin" class="btn btn-primary mt-md-4">Login</button>
        </div>
      </div>
      <div class="form-text mt-2">Gunakan akun dummy: <code>adm001 / 1234</code>.</div>
    </div>
  </div>

  <!-- Dashboard -->
  <div id="dashWrap" class="d-none">
    <div class="card border-0 shadow-sm">
      <div class="card-body">
        <div class="row g-3 align-items-end">
          <div class="col-12 col-md-3">
            <label class="form-label">Tanggal</label>
            <input id="datePick" type="date" class="form-control">
          </div>
          <div class="col-12 col-md-3">
            <label class="form-label">Divisi</label>
            <select id="divFilter" class="form-select">
              <option value="All">All</option>
            </select>
          </div>
          <div class="col-12 col-md-6 d-grid d-md-flex gap-2">
            <button id="btnReload" class="btn btn-outline-primary">Muat Data</button>
            <button id="btnHolidayToday" class="btn btn-outline-secondary">Set Hari Ini Libur</button>
            <button id="btnMaterialize" class="btn btn-outline-danger">Materialize Alpha</button>
          </div>
        </div>

        <hr class="my-3">

        <!-- Toolbar -->
        <div class="row g-2 align-items-stretch">
          <div class="col-12 col-md-5">
            <input id="searchInput" class="form-control" placeholder="Cari nama / ID / divisi / status…">
          </div>
          <div class="col-12 col-md-2">
            <select id="pageSize" class="form-select w-100">
              <option value="10" selected>10 / halaman</option>
              <option value="20">20 / halaman</option>
              <option value="50">50 / halaman</option>
              <option value="100">100 / halaman</option>
            </select>
          </div>
          <div class="col-12 col-md-5 d-grid d-md-flex gap-2">
            <button id="btnExportFiltered" class="btn btn-success w-100 w-md-auto">Export CSV (Filter)</button>
            <button id="btnExportAll" class="btn btn-outline-success w-100 w-md-auto">Export CSV (Semua)</button>
          </div>
        </div>

        <!-- Ringkasan -->
        <div id="summary" class="row text-center g-2 mt-3">
          <div class="col-6 col-md"><div class="p-2 bg-white border rounded">Total<br><span id="sumTotal" class="fw-bold">0</span></div></div>
          <div class="col-6 col-md"><div class="p-2 bg-white border rounded">Masuk<br><span id="sumMasuk" class="fw-bold text-success">0</span></div></div>
          <div class="col-6 col-md"><div class="p-2 bg-white border rounded">Selesai<br><span id="sumSelesai" class="fw-bold">0</span></div></div>
          <div class="col-6 col-md"><div class="p-2 bg-white border rounded">Izin<br><span id="sumIzin" class="fw-bold text-warning">0</span></div></div>
          <div class="col-6 col-md"><div class="p-2 bg-white border rounded">Libur<br><span id="sumLibur" class="fw-bold">0</span></div></div>
          <div class="col-6 col-md"><div class="p-2 bg-white border rounded">Alpha<br><span id="sumAlpha" class="fw-bold text-danger">0</span></div></div>
        </div>

        <!-- Hint geser (mobile only) -->
        <div class="d-block d-md-none small text-muted mt-3">Geser tabel ke samping jika kolom tidak terlihat →</div>

        <!-- Tabel (swipeable) -->
        <div id="tableWrap" class="table-responsive overflow-auto mt-2" style="-webkit-overflow-scrolling: touch;">
          <table class="table table-sm table-bordered table-hover table-striped align-middle mb-0">
            <thead class="table-primary">
              <tr>
                <th role="button" data-sort-key="name">Nama <span class="sort-indicator"></span></th>
                <th class="d-none d-sm-table-cell" role="button" data-sort-key="division">Divisi <span class="sort-indicator"></span></th>
                <th role="button" data-sort-key="check_in">In <span class="sort-indicator"></span></th>
                <th role="button" data-sort-key="check_out">Out <span class="sort-indicator"></span></th>
                <th role="button" data-sort-key="status_view">Status <span class="sort-indicator"></span></th>
                <th class="d-none d-md-table-cell">Catatan</th>
                <th class="text-center">Derived</th>
                <th>Aksi</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>

        <!-- Pagination -->
        <div class="d-flex flex-column flex-md-row gap-2 justify-content-between align-items-md-center border-top py-2">
          <div><span id="resultInfo" class="text-muted small"></span></div>
          <div id="pageInfo" class="small text-muted"></div>
          <nav>
            <ul class="pagination pagination-sm mb-0">
              <li class="page-item"><button id="firstPage" class="page-link" type="button" aria-label="First">«</button></li>
              <li class="page-item"><button id="prevPage"  class="page-link" type="button" aria-label="Previous">‹</button></li>
              <li class="page-item"><button id="nextPage"  class="page-link" type="button" aria-label="Next">›</button></li>
              <li class="page-item"><button id="lastPage"  class="page-link" type="button" aria-label="Last">»</button></li>
            </ul>
          </nav>
        </div>

      </div>
    </div>
  </div>
</main>

<!-- Modal Edit -->
<div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Ubah Status & Catatan</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="mb-2">
          <div class="small text-muted">Karyawan</div>
          <div id="modalEmpName" class="fw-semibold">-</div>
          <div id="modalEmpId" class="text-muted small">-</div>
        </div>
        <div class="mb-3">
          <label class="form-label">Status</label>
          <select id="modalStatus" class="form-select">
            <option value="masuk">masuk</option>
            <option value="izin">izin</option>
            <option value="alpha">alpha</option>
            <option value="libur">libur</option>
          </select>
        </div>
        <div class="mb-2">
          <label class="form-label">Catatan</label>
          <textarea id="modalNote" rows="3" class="form-control" placeholder="Tambahkan catatan…"></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button id="modalSave" class="btn btn-primary">Simpan</button>
      </div>
    </div>
  </div>
</div>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="position-fixed top-0 start-0 w-100 h-100 d-none" style="background:rgba(255,255,255,.75); z-index:1080;">
  <div class="h-100 d-flex align-items-center justify-content-center">
    <div class="text-center">
      <div class="spinner-border text-primary" role="status" aria-hidden="true"></div>
      <div id="loadingMsg" class="mt-2 fw-semibold">Memuat…</div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="./admin.js"></script>
</body>
</html>
